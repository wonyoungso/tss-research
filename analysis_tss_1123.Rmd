---
title: "analysis_tss_experiment_1123"
author: "Wonyoung So"
date: "11/23/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(foreign)
require(tidyverse)
require(rdrobust)
require(stargazer)
require(httr)
require(jsonlite)
require(ggplot2)
require(dplyr)
require(miceadds)
library(miceadds)
require(texreg)
library(sandwich)
library(lmtest)
library(nnet)
library(modelsummary)
```

## Import Data

```{r importdata, include=FALSE, message = FALSE}
tss_df <- fromJSON("./mturk_landlords_decisions_06-2021.json")

tss_df <- tss_df %>% mutate(yesno = ifelse(accept_type == "No", 0, 1))
tss_df <- tss_df %>% 
  mutate(security_deposit2 = ifelse(is.na(security_deposit), 0, security_deposit))

tss_df$view_mode <- as.factor(tss_df$view_mode)
tss_df$view_mode <- relevel(tss_df$view_mode, ref="Type 1")

tss_df$score <- as.factor(tss_df$score)
tss_df$score <- relevel(tss_df$score, ref="MID")

tss_df
```



## Yes - No Logistic Regression

```{r}
logit_wo_cluster <- glm(data = tss_df, formula = yesno ~ view_mode * score, family = "binomial")
coeftest(logit_wo_cluster, vcov. = vcovCL(logit_wo_cluster,  cluster=tss_df$user_id, type ="HC2"))

model_2 <- miceadds::glm.cluster(data = tss_df, formula = yesno ~ view_mode * score + okay_blanket_policy + number_of_unit + race_ethnicity + gender + income, cluster="user_id", family = "binomial")

#coeftest(logit_wo_cluster, vcov. = vcovCL(logit_wo_cluster, cluster=tss_df$user_id, type ="HC0"))
#coeftest(logit_wo_cluster_w_covariate, vcov. = vcovCL(logit_wo_cluster_w_covariate, cluster=tss_df$user_id, type ="HC0"))

model_1
```

```{r}


```